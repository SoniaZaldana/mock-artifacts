<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<vdb name="csv" version="1">
<description/>
<property name="validationDateTime" value="Thu Sep 14 12:39:17 CEST 2017"/>
<property name="validationVersion" value="8.12.5"/>
    
<model name="bqt" type="VIRTUAL">
<property name="imports" value="sourceModel"/>
<metadata type="DDL"><![CDATA[

CREATE VIEW SmallA (
	intkey integer OPTIONS(NAMEINSOURCE 'INTKEY', UPDATABLE 'FALSE'),
	stringkey string(10) OPTIONS(NAMEINSOURCE 'STRINGKEY', UPDATABLE 'FALSE'),
	intnum integer OPTIONS(NAMEINSOURCE 'INTNUM', UPDATABLE 'FALSE'),
	stringnum string(10) OPTIONS(NAMEINSOURCE 'STRINGNUM', UPDATABLE 'FALSE'),
	floatnum float OPTIONS(NAMEINSOURCE 'FLOATNUM', UPDATABLE 'FALSE'),
	longnum long OPTIONS(NAMEINSOURCE 'LONGNUM', UPDATABLE 'FALSE'),
	doublenum double OPTIONS(NAMEINSOURCE 'DOUBLENUM', UPDATABLE 'FALSE'),
	bytenum byte OPTIONS(NAMEINSOURCE 'BYTENUM', UPDATABLE 'FALSE'),
	datevalue date OPTIONS(NAMEINSOURCE 'DATEVALUE', UPDATABLE 'FALSE'),
	timevalue time OPTIONS(NAMEINSOURCE 'TIMEVALUE', UPDATABLE 'FALSE'),
	timestampvalue timestamp OPTIONS(NAMEINSOURCE 'TIMESTAMPVALUE', UPDATABLE 'FALSE'),
	booleanvalue boolean OPTIONS(NAMEINSOURCE 'BOOLEANVALUE', UPDATABLE 'FALSE'),
	charvalue char OPTIONS(NAMEINSOURCE 'CHARVALUE', UPDATABLE 'FALSE'),
	shortvalue short OPTIONS(NAMEINSOURCE 'SHORTVALUE', UPDATABLE 'FALSE'),
	bigintegervalue biginteger OPTIONS(NAMEINSOURCE 'BIGINTEGERVALUE', UPDATABLE 'FALSE'),
	bigdecimalvalue bigdecimal OPTIONS(NAMEINSOURCE 'BIGDECIMALVALUE', UPDATABLE 'FALSE'),
	objectvalue object OPTIONS(NAMEINSOURCE 'objectvalue', UPDATABLE 'FALSE'),
	PRIMARY KEY(intkey)
) 
AS
	SELECT 
	A.INTKEY, A.STRINGKEY, A.INTNUM, A.STRINGNUM, A.FLOATNUM, A.LONGNUM, A.DOUBLENUM, A.BYTENUM, A.DATEVALUE, A.TIMEVALUE, A.TIMESTAMPVALUE, A.BOOLEANVALUE, A.CHARVALUE, A.SHORTVALUE, A.BIGINTEGERVALUE, A.BIGDECIMALVALUE, A.objectvalue
FROM
	(EXEC sourceModel.getTextFiles('smallaCsv.csv')) AS f, TEXTTABLE(file COLUMNS INTKEY integer, STRINGKEY string, INTNUM integer, STRINGNUM string, FLOATNUM float, LONGNUM long, DOUBLENUM double, BYTENUM byte, DATEVALUE date, TIMEVALUE time, TIMESTAMPVALUE timestamp, BOOLEANVALUE boolean, CHARVALUE char, SHORTVALUE short, BIGINTEGERVALUE biginteger, BIGDECIMALVALUE bigdecimal, objectvalue object  HEADER) AS A;

CREATE VIEW SmallB (
	intkey integer OPTIONS(NAMEINSOURCE 'INTKEY', UPDATABLE 'FALSE'),
	stringkey string(10) OPTIONS(NAMEINSOURCE 'STRINGKEY', UPDATABLE 'FALSE'),
	intnum integer OPTIONS(NAMEINSOURCE 'INTNUM', UPDATABLE 'FALSE'),
	stringnum string(10) OPTIONS(NAMEINSOURCE 'STRINGNUM', UPDATABLE 'FALSE'),
	floatnum float OPTIONS(NAMEINSOURCE 'FLOATNUM', UPDATABLE 'FALSE'),
	longnum long OPTIONS(NAMEINSOURCE 'LONGNUM', UPDATABLE 'FALSE'),
	doublenum double OPTIONS(NAMEINSOURCE 'DOUBLENUM', UPDATABLE 'FALSE'),
	bytenum byte OPTIONS(NAMEINSOURCE 'BYTENUM', UPDATABLE 'FALSE'),
	datevalue date OPTIONS(NAMEINSOURCE 'DATEVALUE', UPDATABLE 'FALSE'),
	timevalue time OPTIONS(NAMEINSOURCE 'TIMEVALUE', UPDATABLE 'FALSE'),
	timestampvalue timestamp OPTIONS(NAMEINSOURCE 'TIMESTAMPVALUE', UPDATABLE 'FALSE'),
	booleanvalue boolean OPTIONS(NAMEINSOURCE 'BOOLEANVALUE', UPDATABLE 'FALSE'),
	charvalue char OPTIONS(NAMEINSOURCE 'CHARVALUE', UPDATABLE 'FALSE'),
	shortvalue short OPTIONS(NAMEINSOURCE 'SHORTVALUE', UPDATABLE 'FALSE'),
	bigintegervalue biginteger OPTIONS(NAMEINSOURCE 'BIGINTEGERVALUE', UPDATABLE 'FALSE'),
	bigdecimalvalue bigdecimal OPTIONS(NAMEINSOURCE 'BIGDECIMALVALUE', UPDATABLE 'FALSE'),
	objectvalue object OPTIONS(NAMEINSOURCE 'objectvalue', UPDATABLE 'FALSE'),
	PRIMARY KEY(intkey)
) 
AS
	SELECT
		A.INTKEY, A.STRINGKEY, A.INTNUM, A.STRINGNUM, A.FLOATNUM, A.LONGNUM, A.DOUBLENUM, A.BYTENUM, A.DATEVALUE, A.TIMEVALUE, A.TIMESTAMPVALUE, A.BOOLEANVALUE, A.CHARVALUE, A.SHORTVALUE, A.BIGINTEGERVALUE, A.BIGDECIMALVALUE, A.objectvalue
	FROM
		(EXEC sourceModel.getTextFiles('smallbCsv.csv')) AS f, TEXTTABLE(f.file COLUMNS INTKEY integer, STRINGKEY string, INTNUM integer, STRINGNUM string, FLOATNUM float, LONGNUM long, DOUBLENUM double, BYTENUM byte, DATEVALUE date, TIMEVALUE time, TIMESTAMPVALUE timestamp, BOOLEANVALUE boolean, CHARVALUE char, SHORTVALUE short, BIGINTEGERVALUE biginteger, BIGDECIMALVALUE bigdecimal, objectvalue object HEADER) AS A;

CREATE VIEW MediumA (
	intkey integer OPTIONS(NAMEINSOURCE 'INTKEY', UPDATABLE 'FALSE'),
	stringkey string(10) OPTIONS(NAMEINSOURCE 'STRINGKEY', UPDATABLE 'FALSE'),
	intnum integer OPTIONS(NAMEINSOURCE 'INTNUM', UPDATABLE 'FALSE'),
	stringnum string(10) OPTIONS(NAMEINSOURCE 'STRINGNUM', UPDATABLE 'FALSE'),
	floatnum float OPTIONS(NAMEINSOURCE 'FLOATNUM', UPDATABLE 'FALSE'),
	longnum long OPTIONS(NAMEINSOURCE 'LONGNUM', UPDATABLE 'FALSE'),
	doublenum double OPTIONS(NAMEINSOURCE 'DOUBLENUM', UPDATABLE 'FALSE'),
	bytenum byte OPTIONS(NAMEINSOURCE 'BYTENUM', UPDATABLE 'FALSE'),
	datevalue date OPTIONS(NAMEINSOURCE 'DATEVALUE', UPDATABLE 'FALSE'),
	timevalue time OPTIONS(NAMEINSOURCE 'TIMEVALUE', UPDATABLE 'FALSE'),
	timestampvalue timestamp OPTIONS(NAMEINSOURCE 'TIMESTAMPVALUE', UPDATABLE 'FALSE'),
	booleanvalue boolean OPTIONS(NAMEINSOURCE 'BOOLEANVALUE', UPDATABLE 'FALSE'),
	charvalue char OPTIONS(NAMEINSOURCE 'CHARVALUE', UPDATABLE 'FALSE'),
	shortvalue short OPTIONS(NAMEINSOURCE 'SHORTVALUE', UPDATABLE 'FALSE'),
	bigintegervalue biginteger OPTIONS(NAMEINSOURCE 'BIGINTEGERVALUE', UPDATABLE 'FALSE'),
	bigdecimalvalue bigdecimal OPTIONS(NAMEINSOURCE 'BIGDECIMALVALUE', UPDATABLE 'FALSE'),
	objectvalue object OPTIONS(NAMEINSOURCE 'objectvalue', UPDATABLE 'FALSE'),
	PRIMARY KEY(intkey)
) 
AS
	SELECT
		A.INTKEY, A.STRINGKEY, A.INTNUM, A.STRINGNUM, A.FLOATNUM, A.LONGNUM, A.DOUBLENUM, A.BYTENUM, A.DATEVALUE, A.TIMEVALUE, A.TIMESTAMPVALUE, A.BOOLEANVALUE, A.CHARVALUE, A.SHORTVALUE, A.BIGINTEGERVALUE, A.BIGDECIMALVALUE, A.objectvalue
	FROM
		(EXEC sourceModel.getTextFiles('mediumaCsv.csv')) AS f, TEXTTABLE(f.file COLUMNS INTKEY integer, STRINGKEY string, INTNUM integer, STRINGNUM string, FLOATNUM float, LONGNUM long, DOUBLENUM double, BYTENUM byte, DATEVALUE date, TIMEVALUE time, TIMESTAMPVALUE timestamp, BOOLEANVALUE boolean, CHARVALUE char, SHORTVALUE short, BIGINTEGERVALUE biginteger, BIGDECIMALVALUE bigdecimal, objectvalue object HEADER) AS A;

CREATE VIEW MediumB (
	intkey integer OPTIONS(NAMEINSOURCE 'INTKEY', UPDATABLE 'FALSE'),
	stringkey string(10) OPTIONS(NAMEINSOURCE 'STRINGKEY', UPDATABLE 'FALSE'),
	intnum integer OPTIONS(NAMEINSOURCE 'INTNUM', UPDATABLE 'FALSE'),
	stringnum string(10) OPTIONS(NAMEINSOURCE 'STRINGNUM', UPDATABLE 'FALSE'),
	floatnum float OPTIONS(NAMEINSOURCE 'FLOATNUM', UPDATABLE 'FALSE'),
	longnum long OPTIONS(NAMEINSOURCE 'LONGNUM', UPDATABLE 'FALSE'),
	doublenum double OPTIONS(NAMEINSOURCE 'DOUBLENUM', UPDATABLE 'FALSE'),
	bytenum byte OPTIONS(NAMEINSOURCE 'BYTENUM', UPDATABLE 'FALSE'),
	datevalue date OPTIONS(NAMEINSOURCE 'DATEVALUE', UPDATABLE 'FALSE'),
	timevalue time OPTIONS(NAMEINSOURCE 'TIMEVALUE', UPDATABLE 'FALSE'),
	timestampvalue timestamp OPTIONS(NAMEINSOURCE 'TIMESTAMPVALUE', UPDATABLE 'FALSE'),
	booleanvalue boolean OPTIONS(NAMEINSOURCE 'BOOLEANVALUE', UPDATABLE 'FALSE'),
	charvalue char OPTIONS(NAMEINSOURCE 'CHARVALUE', UPDATABLE 'FALSE'),
	shortvalue short OPTIONS(NAMEINSOURCE 'SHORTVALUE', UPDATABLE 'FALSE'),
	bigintegervalue biginteger OPTIONS(NAMEINSOURCE 'BIGINTEGERVALUE', UPDATABLE 'FALSE'),
	bigdecimalvalue bigdecimal OPTIONS(NAMEINSOURCE 'BIGDECIMALVALUE', UPDATABLE 'FALSE'),
	objectvalue object OPTIONS(NAMEINSOURCE 'objectvalue', UPDATABLE 'FALSE'),
	PRIMARY KEY(intkey)
) 
AS
	SELECT
		A.INTKEY, A.STRINGKEY, A.INTNUM, A.STRINGNUM, A.FLOATNUM, A.LONGNUM, A.DOUBLENUM, A.BYTENUM, A.DATEVALUE, A.TIMEVALUE, A.TIMESTAMPVALUE, A.BOOLEANVALUE, A.CHARVALUE, A.SHORTVALUE, A.BIGINTEGERVALUE, A.BIGDECIMALVALUE, A.objectvalue
	FROM
		(EXEC sourceModel.getTextFiles('mediumbCsv.csv')) AS f, TEXTTABLE(f.file COLUMNS INTKEY integer, STRINGKEY string, INTNUM integer, STRINGNUM string, FLOATNUM float, LONGNUM long, DOUBLENUM double, BYTENUM byte, DATEVALUE date, TIMEVALUE time, TIMESTAMPVALUE timestamp, BOOLEANVALUE boolean, CHARVALUE char, SHORTVALUE short, BIGINTEGERVALUE biginteger, BIGDECIMALVALUE bigdecimal, objectvalue object HEADER) AS A;

CREATE VIEW LargeB (
	intkey integer OPTIONS(NAMEINSOURCE 'INTKEY', UPDATABLE 'FALSE'),
	stringkey string(10) OPTIONS(NAMEINSOURCE 'STRINGKEY', UPDATABLE 'FALSE'),
	intnum integer OPTIONS(NAMEINSOURCE 'INTNUM', UPDATABLE 'FALSE'),
	stringnum string(10) OPTIONS(NAMEINSOURCE 'STRINGNUM', UPDATABLE 'FALSE'),
	floatnum float OPTIONS(NAMEINSOURCE 'FLOATNUM', UPDATABLE 'FALSE'),
	longnum long OPTIONS(NAMEINSOURCE 'LONGNUM', UPDATABLE 'FALSE'),
	doublenum double OPTIONS(NAMEINSOURCE 'DOUBLENUM', UPDATABLE 'FALSE'),
	bytenum byte OPTIONS(NAMEINSOURCE 'BYTENUM', UPDATABLE 'FALSE'),
	datevalue date OPTIONS(NAMEINSOURCE 'DATEVALUE', UPDATABLE 'FALSE'),
	timevalue time OPTIONS(NAMEINSOURCE 'TIMEVALUE', UPDATABLE 'FALSE'),
	timestampvalue timestamp OPTIONS(NAMEINSOURCE 'TIMESTAMPVALUE', UPDATABLE 'FALSE'),
	booleanvalue boolean OPTIONS(NAMEINSOURCE 'BOOLEANVALUE', UPDATABLE 'FALSE'),
	charvalue char OPTIONS(NAMEINSOURCE 'CHARVALUE', UPDATABLE 'FALSE'),
	shortvalue short OPTIONS(NAMEINSOURCE 'SHORTVALUE', UPDATABLE 'FALSE'),
	bigintegervalue biginteger OPTIONS(NAMEINSOURCE 'BIGINTEGERVALUE', UPDATABLE 'FALSE'),
	bigdecimalvalue bigdecimal OPTIONS(NAMEINSOURCE 'BIGDECIMALVALUE', UPDATABLE 'FALSE'),
	objectvalue object OPTIONS(NAMEINSOURCE 'objectvalue', UPDATABLE 'FALSE'),
	PRIMARY KEY(intkey)
) 
AS
	SELECT
		A.INTKEY, A.STRINGKEY, A.INTNUM, A.STRINGNUM, A.FLOATNUM, A.LONGNUM, A.DOUBLENUM, A.BYTENUM, A.DATEVALUE, A.TIMEVALUE, A.TIMESTAMPVALUE, A.BOOLEANVALUE, A.CHARVALUE, A.SHORTVALUE, A.BIGINTEGERVALUE, A.BIGDECIMALVALUE, A.objectvalue
	FROM
		(EXEC sourceModel.getTextFiles('largebCsv.csv')) AS f, TEXTTABLE(f.file COLUMNS INTKEY integer, STRINGKEY string, INTNUM integer, STRINGNUM string, FLOATNUM float, LONGNUM long, DOUBLENUM double, BYTENUM byte, DATEVALUE date, TIMEVALUE time, TIMESTAMPVALUE timestamp, BOOLEANVALUE boolean, CHARVALUE char, SHORTVALUE short, BIGINTEGERVALUE biginteger, BIGDECIMALVALUE bigdecimal, objectvalue object HEADER) AS A;

CREATE VIEW LargeA (
	intkey integer OPTIONS(NAMEINSOURCE 'INTKEY', UPDATABLE 'FALSE'),
	stringkey string(10) OPTIONS(NAMEINSOURCE 'STRINGKEY', UPDATABLE 'FALSE'),
	intnum integer OPTIONS(NAMEINSOURCE 'INTNUM', UPDATABLE 'FALSE'),
	stringnum string(10) OPTIONS(NAMEINSOURCE 'STRINGNUM', UPDATABLE 'FALSE'),
	floatnum float OPTIONS(NAMEINSOURCE 'FLOATNUM', UPDATABLE 'FALSE'),
	longnum long OPTIONS(NAMEINSOURCE 'LONGNUM', UPDATABLE 'FALSE'),
	doublenum double OPTIONS(NAMEINSOURCE 'DOUBLENUM', UPDATABLE 'FALSE'),
	bytenum byte OPTIONS(NAMEINSOURCE 'BYTENUM', UPDATABLE 'FALSE'),
	datevalue date OPTIONS(NAMEINSOURCE 'DATEVALUE', UPDATABLE 'FALSE'),
	timevalue time OPTIONS(NAMEINSOURCE 'TIMEVALUE', UPDATABLE 'FALSE'),
	timestampvalue timestamp OPTIONS(NAMEINSOURCE 'TIMESTAMPVALUE', UPDATABLE 'FALSE'),
	booleanvalue boolean OPTIONS(NAMEINSOURCE 'BOOLEANVALUE', UPDATABLE 'FALSE'),
	charvalue char OPTIONS(NAMEINSOURCE 'CHARVALUE', UPDATABLE 'FALSE'),
	shortvalue short OPTIONS(NAMEINSOURCE 'SHORTVALUE', UPDATABLE 'FALSE'),
	bigintegervalue biginteger OPTIONS(NAMEINSOURCE 'BIGINTEGERVALUE', UPDATABLE 'FALSE'),
	bigdecimalvalue bigdecimal OPTIONS(NAMEINSOURCE 'BIGDECIMALVALUE', UPDATABLE 'FALSE'),
	objectvalue object OPTIONS(NAMEINSOURCE 'objectvalue', UPDATABLE 'FALSE'),
	PRIMARY KEY(intkey)
) 
AS
	SELECT
		A.INTKEY, A.STRINGKEY, A.INTNUM, A.STRINGNUM, A.FLOATNUM, A.LONGNUM, A.DOUBLENUM, A.BYTENUM, A.DATEVALUE, A.TIMEVALUE, A.TIMESTAMPVALUE, A.BOOLEANVALUE, A.CHARVALUE, A.SHORTVALUE, A.BIGINTEGERVALUE, A.BIGDECIMALVALUE, A.objectvalue
	FROM
		(EXEC sourceModel.getTextFiles('largeaCsv.csv')) AS f, TEXTTABLE(f.file COLUMNS INTKEY integer, STRINGKEY string, INTNUM integer, STRINGNUM string, FLOATNUM float, LONGNUM long, DOUBLENUM double, BYTENUM byte, DATEVALUE date, TIMEVALUE time, TIMESTAMPVALUE timestamp, BOOLEANVALUE boolean, CHARVALUE char, SHORTVALUE short, BIGINTEGERVALUE biginteger, BIGDECIMALVALUE bigdecimal, objectvalue object HEADER) AS A;
]]></metadata>

</model>
    
<model name="sourceModel">
<source connection-jndi-name="java:/csvDS" name="sourceModel" translator-name="file"/>
<metadata type="DDL"><![CDATA[

CREATE FOREIGN PROCEDURE getTextFiles (
	IN pathAndExt string(4000) NOT NULL
) RETURNS
	TABLE (
		file clob,
		filePath string(4000)		
) OPTIONS(UPDATECOUNT '1');

]]></metadata>
</model>

</vdb>
